---
layout: post
title: "Концепция умного дома"
published: "2022.12.06"
updated: "2022.12.06"
description: "Статья посвящена краткому описанию концепций, которой я придерживаюсь при создании умного дома в своей квартире."
tags: iot, smart-home
---

## С чего все началось

Когда у меня появилась собственная квартира, я захотел сделать ее максимально удобной для проживания в ней. В то же время на рынке начало появляться множество различных решений для автоматизации рутинных домашних задач. К примеру ежедневную уборку заменили роботы-пылесосы. Анализируя их возможности и ограничения (
_к сожалению до сих пор их очень много_), я приступил к проработке собственного "
_идеального_" концепта умного дома. Я сразу же столкнулся с рядом технических проблем в большинстве устройств. Почти все они завязаны на работу с глобальным, централизованным сервером. Примером таких устройств являются умные лампы [yeelight](https://yeelight.com), устройства линейки [Tuya](https://www.tuya.com/) и т.п. Каждое устройства одного производителя добавляются, настраиваются и управляются через единое приложение. Некоторые приложения поддерживают (частично) сторонние устройства. Но все взаимодействие придерживается логике: приложение -> сервер -> устройство. Редко бывает так, что устройство работает напрямую с приложением (по bluetooth). Последний тренд компаний - обязательная авторизация... Это еще одна проблема с которой я столкнулся. Я не могу создать одну учетную запись, и использовать ее во всех приложениях...

## _Манифест "умного дома"_

Для себя я решил что устройства должны работать через wifi. Я хорошо знаком с семейством контроллеров ESP8266 и ESP32. Так же представляю возможности сетевых протоколов и физической работы wifi. Сети на базе bluetooth я не рассматриваю из-за, дороговизны, малой распространенности и общей закрытости устройства. Zigbee так же показался мне недостаточно развит, он так же на порядок дороже чем wifi и представлен в виде десятка производителей, не все из которых поддерживают перепрошивку на сторонний софт. Из этого родились следующие требования к системе:

* Работа через wifi.
* Легкая настройка соединения с wifi.
* Работоспособность при полном отсутствие wifi (_в чистом поле_).
* Использование wifi для информирования об изменениях.
* Использование wifi для полной возможности управления.
* Возможность автоматического обновления глобальной информации (время/дата/погода), автономно, без использования промежуточного сервера.
* Выход из строя устройства не влияет на работу других устройств.
* Любое устройство можно заменить его простым аналогом в течении короткого времени (умный выключатель легко поменять на обычный выключатель).
* Устройство не должно выполнять больше одной функции, для которой оно создавалось (выключатель не должен отслеживать время суток для корректной работы).
* Если устройство предоставляет дополнительную информацию о себе, но это не основна его обязанность, она не может быть использована как основа для работы других устройств. (пример: настольная лампа может мерить температуру, на основе которой работает кондиционер).

Так же я определил для себя дополнительные требования, не являющиеся обязательными, но желательными, если они возможны:

* У каждого устройства есть свой web интерфейс, работающий автономно.
* Каждое устройство умеет создавать автономную точку доступа.
* Каждое устройство предусматривает возможность общения по одному из IoT протоколов (Rest API, MQTT и т.п.).

## Что удовлетворяет этим требованиям

Как я уже писал выше, я знаком с контролерами ESP8266 и ESP32. Для этих контроллеров существует SDK и несколько готовых открытых прошивок: [ESPHome](https://github.com/esphome/esphome), [ESPEasy](https://github.com/letscontrolit/ESPEasy) и [Tasmota](https://github.com/arendst/tasmota). Я остановился на последней. Это обусловлено большой базой поддерживаемых устройств. А так же эта прошивка позволяет гибко настраивать контроллер и тем самым использовать в любых устройствах. Сама концепция проекта предполагает автономное использование устройства. Большинство устройств имеют минимально-необходимый функционалом. Все это сделало возможность для дальнейшего развития своей идеи умного дома.
